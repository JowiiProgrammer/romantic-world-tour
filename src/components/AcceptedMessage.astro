---
import { FaFileContract, FaDownload, FaTimes } from 'react-icons/fa';
---

<style>
  @keyframes heartbeat {
    0% {
      transform: scale(1);
    }
    14% {
      transform: scale(1.3);
    }
    28% {
      transform: scale(1);
    }
    42% {
      transform: scale(1.3);
    }
    70% {
      transform: scale(1);
    }
  }

  .heartbeat {
    animation: heartbeat 1.5s infinite;
    transform-origin: center;
  }
</style>

<div id="acceptedMessage" class="fixed inset-0 flex flex-col items-center justify-center bg-black bg-opacity-75 z-50 hidden p-4">
  <div class="relative bg-white rounded-lg p-4 sm:p-6 max-w-sm sm:max-w-md md:max-w-lg w-full mx-auto">
    <button id="closeAcceptedMessage" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
      <FaTimes className="w-5 h-5 sm:w-6 sm:h-6" />
      <span class="sr-only">Cerrar mensaje</span>
    </button>
    <div class="text-2xl sm:text-3xl font-bold text-gray-800 mb-4 text-center">
      ¡Nuestro viaje de amor comienza ahora!
    </div>
    
    <div class="relative w-64 h-64 mb-8 mx-auto">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-full h-full heartbeat">
        <path fill="#FF4B4B" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
      </svg>
      <div class="absolute bottom-1/4 left-1/4 transform -translate-x-1/2 translate-y-1/2">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 128 128" class="w-12 h-12">
          <path fill="#757E40" d="M55.88 32.41S17.4 43.11 14.4 47.24S6.23 59.02 5.76 75.4c-.38 13.14 6.95 46.93 42.98 48.05c36.79 1.15 50.49-23.09 57.06-38.1c5.92-13.54 5.82-29.09 9.57-36.23s7.13-13.33 6.95-21.4s-3.19-15.02-8.45-18.4s-9.76-2.82-12.01-3.38s-45.98 26.47-45.98 26.47"/>
          <path fill="#AFB42A" d="M62.63 18.9c-15.96 6.57-37.17 12.76-47.3 27.03c-9.15 12.88-12.2 28.9.19 47.67c11.31 17.14 41.46 24.45 64.01 8.26c20.65-14.83 22.52-36.6 28.72-51.06s19.24-33.46 3.57-42.8c-16.71-9.94-36.58 5.71-49.19 10.9"/>
          <path fill="#FFF69D" d="M108.25 12.14c-7.59-4.38-17.27-2.44-27.97 2.82s-18.96 9.2-22.71 10.51C53.81 26.78 21.87 38.48 15.71 54c-5.07 12.76-3.75 29.47 9.57 41.67s46.93 11.45 59.88-6.95s13.51-33.22 16.33-39.79s8.96-16.19 10.7-21.4c2.06-6.19.94-12.57-3.94-15.39"/>
          <path fill="#855C52" d="M71.45 47.8c-6.01-7.13-28.91-4.88-36.79 6.38s-4.6 20.41-.75 25.34C38.6 85.53 51.37 90.97 63 82.9s15.04-27.28 8.45-35.1"/>
          <path fill="#D67659" d="M47.32 60.62c-2.96 4.34-1.48 11.34-6.57 11.67s-8.05-7.84-4.44-14.68c3.9-7.38 13.14-10.67 15.77-7.17c2.64 3.51-1.95 6.06-4.76 10.18"/>
        </svg>
      </div>
      <div class="absolute bottom-1/4 right-1/4 transform translate-x-1/2 translate-y-1/2">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 128 128" class="w-12 h-12">
          <path fill="#757E40" d="M55.88 32.41S17.4 43.11 14.4 47.24S6.23 59.02 5.76 75.4c-.38 13.14 6.95 46.93 42.98 48.05c36.79 1.15 50.49-23.09 57.06-38.1c5.92-13.54 5.82-29.09 9.57-36.23s7.13-13.33 6.95-21.4s-3.19-15.02-8.45-18.4s-9.76-2.82-12.01-3.38s-45.98 26.47-45.98 26.47"/>
          <path fill="#AFB42A" d="M62.63 18.9c-15.96 6.57-37.17 12.76-47.3 27.03c-9.15 12.88-12.2 28.9.19 47.67c11.31 17.14 41.46 24.45 64.01 8.26c20.65-14.83 22.52-36.6 28.72-51.06s19.24-33.46 3.57-42.8c-16.71-9.94-36.58 5.71-49.19 10.9"/>
          <path fill="#FFF69D" d="M108.25 12.14c-7.59-4.38-17.27-2.44-27.97 2.82s-18.96 9.2-22.71 10.51C53.81 26.78 21.87 38.48 15.71 54c-5.07 12.76-3.75 29.47 9.57 41.67s46.93 11.45 59.88-6.95s13.51-33.22 16.33-39.79s8.96-16.19 10.7-21.4c2.06-6.19.94-12.57-3.94-15.39"/>
          <path fill="#855C52" d="M71.45 47.8c-6.01-7.13-28.91-4.88-36.79 6.38s-4.6 20.41-.75 25.34C38.6 85.53 51.37 90.97 63 82.9s15.04-27.28 8.45-35.1"/>
          <path fill="#D67659" d="M47.32 60.62c-2.96 4.34-1.48 11.34-6.57 11.67s-8.05-7.84-4.44-14.68c3.9-7.38 13.14-10.67 15.77-7.17c2.64 3.51-1.95 6.06-4.76 10.18"/>
        </svg>
      </div>
      <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 128 128" class="w-12 h-12">
          <path fill="#757E40" d="M55.88 32.41S17.4 43.11 14.4 47.24S6.23 59.02 5.76 75.4c-.38 13.14 6.95 46.93 42.98 48.05c36.79 1.15 50.49-23.09 57.06-38.1c5.92-13.54 5.82-29.09 9.57-36.23s7.13-13.33 6.95-21.4s-3.19-15.02-8.45-18.4s-9.76-2.82-12.01-3.38s-45.98 26.47-45.98 26.47"/>
          <path fill="#AFB42A" d="M62.63 18.9c-15.96 6.57-37.17 12.76-47.3 27.03c-9.15 12.88-12.2 28.9.19 47.67c11.31 17.14 41.46 24.45 64.01 8.26c20.65-14.83 22.52-36.6 28.72-51.06s19.24-33.46 3.57-42.8c-16.71-9.94-36.58 5.71-49.19 10.9"/>
          <path fill="#FFF69D" d="M108.25 12.14c-7.59-4.38-17.27-2.44-27.97 2.82s-18.96 9.2-22.71 10.51C53.81 26.78 21.87 38.48 15.71 54c-5.07 12.76-3.75 29.47 9.57 41.67s46.93 11.45 59.88-6.95s13.51-33.22 16.33-39.79s8.96-16.19 10.7-21.4c2.06-6.19.94-12.57-3.94-15.39"/>
          <path fill="#855C52" d="M71.45 47.8c-6.01-7.13-28.91-4.88-36.79 6.38s-4.6 20.41-.75 25.34C38.6 85.53 51.37 90.97 63 82.9s15.04-27.28 8.45-35.1"/>
          <path fill="#D67659" d="M47.32 60.62c-2.96 4.34-1.48 11.34-6.57 11.67s-8.05-7.84-4.44-14.68c3.9-7.38 13.14-10.67 15.77-7.17c2.64 3.51-1.95 6.06-4.76 10.18"/>
        </svg>
      </div>
    </div>

    <div class="text-base sm:text-lg text-gray-700 mt-4 text-center">
      Juntos, exploraremos el mundo y nuestro amor crecerá con cada aventura.
    </div>

    <button
      id="openContractBtn"
      class="mt-6 bg-blue-500 text-white px-4 sm:px-6 py-2 rounded-full hover:bg-blue-600 transition-colors duration-300 flex items-center mx-auto text-sm sm:text-base"
    >
      <FaFileContract className="mr-2" />
      Ver Certificado de Relación
    </button>
  </div>
</div>

<div id="contractModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden overflow-y-auto">
  <div class="bg-white rounded-lg p-4 w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg xl:max-w-xl 2xl:max-w-2xl mx-auto">
    <div id="certificate" class="w-full bg-gradient-to-br from-pink-100 to-white p-4 sm:p-6 rounded-lg shadow-lg text-center">
      <div class="flex justify-between items-start mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20">
          <path fill="#FF4B4B" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20">
          <path fill="#FF4B4B" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
        </svg>
      </div>
      
      <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold text-pink-700 mb-4 sm:mb-6">CERTIFICADO DE RELACIÓN</h1>
      
      <p class="text-sm sm:text-base md:text-lg mb-2 sm:mb-4 text-gray-700">
        Este documento certifica oficialmente que
      </p>
      
      <p class="text-xl sm:text-2xl font-bold text-pink-600 mb-2 sm:mb-4">Griselda Figueredo Castillo</p>
      
      <p class="text-lg sm:text-xl font-semibold mb-2 sm:mb-4 text-gray-700">y</p>
      
      <p class="text-xl sm:text-2xl font-bold text-pink-600 mb-2 sm:mb-4">Joel Galindo Aguilar</p>
      
      <p class="text-xs sm:text-sm md:text-base mb-4 sm:mb-6 text-gray-700">
        han decidido iniciar una relación de pareja con todo el amor y compromiso que ello implica.
        Esta unión se formalizó el día <span id="currentDate"></span>.
      </p>
      
      <p class="text-sm sm:text-base md:text-lg italic mb-4 sm:mb-8 text-gray-600">
        "El amor no consiste en mirarse el uno al otro, sino en mirar juntos en la misma dirección." - Antoine de Saint-Exupéry
      </p>
      
      <div class="flex justify-center items-end mt-4">
        <div class="text-center">
          <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Signature-a7bLVC3WvJ19GUHpOvilfeB8Ylf80r.png" alt="Tu firma" class="w-24 h-12 sm:w-32 sm:h-16 mb-2 mx-auto" id="signatureImage" />
          <p class="font-semibold text-sm sm:text-base text-gray-700">Joel Galindo Aguilar</p>
          <p class="text-xs sm:text-sm text-gray-600">Firma</p>
        </div>
      </div>
      
      <div class="mt-4 sm:mt-6 text-xs sm:text-sm text-gray-500">
        <p>Este certificado no tiene validez legal y es puramente simbólico.</p>
        <p>Su valor reside en el compromiso y el amor mutuo de los firmantes.</p>
      </div>
    </div>
    <div class="mt-4 flex justify-between">
      <button
        id="closeContractBtn"
        class="bg-red-500 text-white px-3 py-1 sm:px-4 sm:py-2 rounded-md hover:bg-red-600 transition-colors text-xs sm:text-sm md:text-base"
      >
        Cerrar
      </button>
      <button
        id="downloadBtn"
        class="bg-green-500 text-white px-3 py-1 sm:px-4 sm:py-2 rounded-md hover:bg-green-600 transition-colors flex items-center text-xs sm:text-sm md:text-base"
      >
        <FaDownload className="mr-1 sm:mr-2" />
        Descargar PDF
      </button>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const acceptedMessage = document.getElementById('acceptedMessage');
    const contractModal = document.getElementById('contractModal');
    const openContractBtn = document.getElementById('openContractBtn');
    const closeContractBtn = document.getElementById('closeContractBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const currentDateSpan = document.getElementById('currentDate');
    const closeAcceptedMessage = document.getElementById('closeAcceptedMessage');

    currentDateSpan.textContent = new Date().toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });

    // Función para mostrar el mensaje de aceptación
    window.showAcceptedMessage = () => {
      acceptedMessage.classList.remove('hidden');
    };

    openContractBtn.addEventListener('click', () => {
      acceptedMessage.classList.add('hidden');
      contractModal.classList.remove('hidden');
    });

    closeContractBtn.addEventListener('click', () => {
      contractModal.classList.add('hidden');
    });

    closeAcceptedMessage.addEventListener('click', () => {
      acceptedMessage.classList.add('hidden');
    });

    downloadBtn.addEventListener('click', async () => {
      const certificate = document.getElementById('certificate');
      if (certificate) {
        const canvas = await html2canvas(certificate, {
          scale: 2, // Increase resolution
          useCORS: true, // Enable CORS for images
          backgroundColor: null // Transparent background
        });
        const imgData = canvas.toDataURL('image/png');
        
        // Determine orientation based on image dimensions
        const orientation = canvas.width > canvas.height ? 'l' : 'p';
        
        const pdf = new jspdf.jsPDF({
          orientation: orientation,
          unit: 'mm',
          format: 'a4'
        });
        
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        
        // Calculate scaling factor to fit the image within the PDF
        const scale = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
        
        // Calculate centered position
        const x = (pdfWidth - imgWidth * scale) / 2;
        const y = (pdfHeight - imgHeight * scale) / 2;
        
        pdf.addImage(imgData, 'PNG', x, y, imgWidth * scale, imgHeight * scale);
        pdf.save('certificado_de_relacion.pdf');
      }
    });
  });
</script>